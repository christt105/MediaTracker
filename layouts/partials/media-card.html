<div class="media-card" data-title="{{ lower .Title }}" data-year="{{ .Params.year }}" data-type="{{ .Params.type }}">

    <div class="media-poster">
        <a href="{{ .Permalink }}">
            {{ $img := .Params.image | default "/images/default-poster.png" }}
            <img src="{{ $img | absURL }}" alt="{{ .Title }}" loading="lazy">
        </a>

        {{ $icon := .Params.fa_icon }}

        {{/* Si no hay icono explícito, asignamos uno por defecto según el tipo */}}
        {{ if not $icon }}
        {{ if eq .Params.type "movie" }}
        {{ $icon = "fas fa-film" }}
        {{ else if eq .Params.type "tv" }}
        {{ $icon = "fas fa-tv" }}
        {{ else if eq .Params.type "season" }}
        {{ $icon = "fas fa-tv" }}
        {{ else if eq .Params.type "videogame" }}
        {{ $icon = "fas fa-gamepad" }}
        {{ end }}
        {{ end }}

        {{ if $icon }}
        <div class="badge-type {{ .Params.type }}" title="{{ .Params.type }}">
            <i class="{{ $icon }}"></i>
        </div>
        {{ end }}

        {{ if gt (len (strings.TrimSpace .Content)) 0 }}
        <div class="badge-content" title="Contiene reseña/notas personales">
            <i class="fas fa-file-alt"></i>
        </div>
        {{ end }}

        {{ if and (eq .Params.status "Acabado") .Params.rating }}

        {{ $rating := .Params.rating }}
        {{ $color := "#cccccc" }}
        {{ $icon := "fa-solid fa-star" }}
        {{ $text := "white" }}

        {{ if ge $rating 7 }}
        {{ $color = "#a855f7" }}
        {{ $icon = "fa-solid fa-crown" }}
        {{ else if ge $rating 6 }}
        {{ $color = "#22c55e" }}
        {{ $icon = "fa-solid fa-heart" }}
        {{ else if ge $rating 5 }}
        {{ $color = "#84cc16" }}
        {{ $icon = "fa-solid fa-thumbs-up" }}
        {{ else if ge $rating 4 }}
        {{ $color = "#eab308" }}
        {{ $icon = "fa-solid fa-face-meh" }}
        {{ $text = "black" }}
        {{ else if ge $rating 3 }}
        {{ $color = "#f97316" }}
        {{ $icon = "fa-solid fa-thumbs-down" }}
        {{ else if ge $rating 2 }}
        {{ $color = "#ef4444" }}
        {{ $icon = "fa-solid fa-face-dizzy" }}
        {{ else }}
        {{ $color = "#b91c1c" }}
        {{ $icon = "fa-solid fa-skull" }}
        {{ end }}

        <div class="margin-rating" style="background: {{ $color }};"></div>

        <div class="badge-rating" style="background: {{ $color }}; color: {{ $text }}">
            <i class="{{ $icon }}"></i>
        </div>

        {{ end }}
    </div>

    <div class="media-info">
        <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
        <small>
            {{ if eq .Params.status "Acabado" }}
            {{ $configDateFormat := .Site.Params.dateFormat | default "2 Jan 2006" }}
            {{ if .Date }}
            {{ time.Format $configDateFormat .Date }}
            {{ else }}
            {{ time.Format $configDateFormat .Params.release_date }}
            {{ end }}
            {{ else }}
            {{ .Params.status | default "En curso" }}
            {{ end }}
        </small>
    </div>
</div>